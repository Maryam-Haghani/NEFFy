<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NEFFy: How to Use</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<style>
  #titlearea {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 20px; /* Add top margin */
  }
  #projectinfo {
    display: flex;
    align-items: center;
  }
  #github-link {
    margin-left: auto;
    margin-right: 20px; /* Add a small right margin */
  }
  .green-text {
    color: green; /* Set text color to green */
  }
</style>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <div id="projectinfo">
    <div id="projectalign">
      <div id="projectname">NEFFy</div>
      <div id="projectbrief">NEFF Calculator and MSA File Converter</div>
    </div>
  </div>
  <div id="github-link">
    <a href="https://github.com/Maryam-Haghani/Neffy">
      <svg height="32" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true">
        <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.64 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
      </svg>
      Edit on GitHub
    </a>
  </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">How to Use</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md64"></a>
Table of Contents</h2>
<ul>
<li><a class="el" href="#executable">C++ Executable File</a><ul>
<li><a class="el" href="#neff_computation">NEFF Computation</a><ul>
<li><a class="el" href="#neff_usage">Usage</a></li>
<li><a class="el" href="#neff_parameters">Parameters</a></li>
<li><a class="el" href="#neff_example">Examples</a></li>
</ul>
</li>
<li><a class="el" href="#converter">MSA File Conversion</a><ul>
<li><a class="el" href="#converter_usage">Usage</a></li>
<li><a class="el" href="#converter_parameters">Parameters</a></li>
<li><a class="el" href="#converter_example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="el" href="#python">Python Library</a><ul>
<li><a class="el" href="#python_neff_main">NEFF Computation</a><ul>
<li><a class="el" href="#python_neff">compute_neff: NEFF Computation</a><ul>
<li><a class="el" href="#python_neff_params">Parameters</a></li>
<li><a class="el" href="#python_neff_example">Example</a></li>
</ul>
</li>
<li><a class="el" href="#python_neff_multimer">__compute_multimer_neff__: NEFF Computation for Multimer MSA</a><ul>
<li><a class="el" href="#python_neff_multimer_params">Parameters</a></li>
<li><a class="el" href="#python_neff_multimer_example">Example</a></li>
</ul>
</li>
<li><a class="el" href="#python_neff_residue">__compute_residue_neff__: Per-Residue (column-Wise) NEFF Computation</a><ul>
<li><a class="el" href="#python_neff_residue_params">Parameters</a></li>
<li><a class="el" href="#python_neff_residue_example">Example</a></li>
</ul>
</li>
<li><a class="el" href="#python_neff_masking">__compute_neff_masking__: MSA Masking</a><ul>
<li><a class="el" href="#python_neff_masking_params">Parameters</a></li>
<li><a class="el" href="#python_neff_masking_example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="el" href="#python_converter">__convert_msa__: MSA File Conversion</a><ul>
<li><a class="el" href="#python_convert_msa_params">Parameters</a></li>
<li><a class="el" href="#python_convert_msa_example">Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><br  />
</p>
<p><a class="anchor" id="executable"></a></p>
<h1><a class="anchor" id="autotoc_md65"></a>
C++ Executable File</h1>
<p><a class="anchor" id="neff_computation"></a></p>
<h2><a class="anchor" id="autotoc_md66"></a>
NEFF Computation</h2>
<p><a class="anchor" id="neff_usage"></a></p>
<h3><a class="anchor" id="autotoc_md67"></a>
Usage:</h3>
<div class="fragment"><div class="line">./neff --file=&lt;input_file&gt; [options]</div>
</div><!-- fragment --><p>To calculate NEFF, provide an MSA file and indicate the desired parameters. NEFF will be computed and presented as the result.</p>
<p><a class="anchor" id="neff_parameters"></a></p>
<h3><a class="anchor" id="autotoc_md68"></a>
Parameters:</h3>
<p>The code accepts the following command-line flags: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Flag   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Required   </th><th class="markdownTableHeadNone">Default Value   </th><th class="markdownTableHeadNone">Example    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>--file=&lt;list of filenames&gt;</code>   </td><td class="markdownTableBodyNone">Input files (comma-separated, no spaces) containing multiple sequence alignments   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone"><code>--file=my_alignment.fasta</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>--alphabet=&lt;value&gt;</code>   </td><td class="markdownTableBodyNone">Alphabet of MSA <br  />
 <b>0</b>: Protein <br  />
 <b>1</b>: RNA <br  />
 <b>2</b>: DNA   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone"><code>--alphabet=1</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>--check_validation=[true/false]</code>   </td><td class="markdownTableBodyNone">Validate the input MSA file based on alphabet or not   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">false   </td><td class="markdownTableBodyNone"><code>--check_validation=true</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>--threshold=&lt;value&gt;</code>   </td><td class="markdownTableBodyNone">Similarity threshold for sequence weighting, must be between 0 and 1.   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">0.8   </td><td class="markdownTableBodyNone"><code>--threshold=0.7</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>--norm=&lt;value&gt;</code>   </td><td class="markdownTableBodyNone">Normalization option for NEFF <br  />
 <b>0</b>: Normalize by the square root of sequence length <br  />
 <b>1</b>: Normalize by the sequence length <br  />
 <b>2</b>: No Normalization   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone"><code>--norm=2</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>--omit_query_gaps=[true/false]</code>   </td><td class="markdownTableBodyNone">Omit gap positions of query sequence from all sequences for NEFF computation   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">true   </td><td class="markdownTableBodyNone"><code>--omit_query_gaps=true</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>--is_symmetric =true/false]</code>   </td><td class="markdownTableBodyNone">Consider gaps in number of differences when computing sequence similarity cutoff (asymmetric) or not (symmetric)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">true   </td><td class="markdownTableBodyNone"><code>--is_symmetric=false</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>--non_standard_option=&lt;value&gt;</code>   </td><td class="markdownTableBodyNone">Options for handling non-standard letters of the specified alphabet <br  />
 <b>0</b>: Treat them the same as standard letters <br  />
 <b>1</b>: Consider them as gaps when computing similarity cutoff of sequences (only used in asymmetryc version) <br  />
 <b>2</b>: Consider them as gaps in computing similarity cutoff and checking position of match/mismatch   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone"><code>--non_standard_option=1</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>--depth=&lt;value&gt;</code>   </td><td class="markdownTableBodyNone">Depth of MSA to be used in NEFF computation (starting from the first sequence)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">inf (consider the whole sequence)   </td><td class="markdownTableBodyNone"><code>--depth=10</code> <br  />
(if given value is greater than original depth, it considers the original depth)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>--gap_cutoff=&lt;value&gt;</code>   </td><td class="markdownTableBodyNone">Threshold for considering a position as gappy and removing that (between 0 and 1)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">1 (no gappy position)   </td><td class="markdownTableBodyNone"><code>--gap_cutoff=0.7</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>--pos_start=&lt;value&gt;</code>   </td><td class="markdownTableBodyNone">Start position of each sequence to be considered in NEFF (inclusive)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">1 (the first position)   </td><td class="markdownTableBodyNone"><code>--pos_start=10</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>--pos_end=&lt;value&gt;</code>   </td><td class="markdownTableBodyNone">Last position of each sequence to be considered in NEFF (inclusive)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">inf (consider the whole sequence)   </td><td class="markdownTableBodyNone"><code>--pos_end=50</code> (if given value is greater than the length of the MSA sequences, consider length of sequences in the MSA)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>--only_weights=[true/false]</code>   </td><td class="markdownTableBodyNone">Return only sequence weights, rather than the final NEFF   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">false   </td><td class="markdownTableBodyNone"><code>--only_weights=true</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>--mask_enabled=[true/false]</code>   </td><td class="markdownTableBodyNone">Enable random sequence masking for NEFF calculation and return the masking with the highest NEFF   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">false   </td><td class="markdownTableBodyNone"><code>--mask_enabled=true</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>--mask_frac=&lt;value&gt;</code>   </td><td class="markdownTableBodyNone">Fraction of sequences to be masked in each masking iteration   </td><td class="markdownTableBodyNone">when <em>mask_enabled</em>=true   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone"><code>--mask_frac=0.4</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>--mask_count=&lt;value&gt;</code>   </td><td class="markdownTableBodyNone">Number of masking iterations   </td><td class="markdownTableBodyNone">when <em>mask_enabled</em>=true   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone"><code>--mask_count=0</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>--multimer_MSA=[true/false]</code>   </td><td class="markdownTableBodyNone">Compute NEFF for MSA of a multimer   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">false   </td><td class="markdownTableBodyNone"><code>--multimer_MSA=true</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>--stoichiom=&lt;value&gt;</code>   </td><td class="markdownTableBodyNone">Stochiometry of the multimer   </td><td class="markdownTableBodyNone">when <em>multimer_MSA</em>=true   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><code>--stoichiom=A2B1</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>--chain_length=&lt;list of values&gt;</code>   </td><td class="markdownTableBodyNone">Length of the chains in a heteromer   </td><td class="markdownTableBodyNone">when <em>multimer_MSA</em>=true and multimer is a heteromer   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone"><code>--chain_length=17 45</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>--residue_neff=[true/false]</code>   </td><td class="markdownTableBodyNone">Compute per-residue (column-wise) NEFF   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">false   </td><td class="markdownTableBodyNone"><code>--residue_neff=true</code>   </td></tr>
</table>
<p><a class="anchor" id="neff_example"></a></p>
<h3><a class="anchor" id="autotoc_md69"></a>
Examples:</h3>
<ul>
<li><b>Compute Symmetric NEFF for protein MSA (No Normalization):</b> <div class="fragment"><div class="line">./neff --file=../MSAs/example.a2m --norm=2 </div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA sequence length: 56<br  />
 MSA depth: 5<br  />
 NEFF: 5 <br  />
 </p>
</blockquote>
</li>
</ul>
<p><br  />
</p>
<ul>
<li><b>Compute NEFF for RNA MSA with Default Normalization (sqrt(L)) using 50% Gap Cutoff:</b> <div class="fragment"><div class="line">./neff --file=../MSAs/rna.fasta --gap_cutoff=0.5 --alphabet=1</div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA sequence length: 28<br  />
 MSA depth: 1176<br  />
 NEFF: 5.08477 </p>
</blockquote>
</li>
</ul>
<p><br  />
</p>
<ul>
<li><b>Compute <a class="el" href="struct_sequence.html">Sequence</a> Weights for protein MSA with Default Normalization (sqrt(L)):</b> <div class="fragment"><div class="line">./neff --file=../MSAs/example.a2m --only_weights=true --threshold=0.2</div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA sequence length: 56<br  />
 MSA depth: 5<br  />
 <a class="el" href="struct_sequence.html">Sequence</a> weights:<br  />
 1 0.333333 0.25 0.333333 0.25 </p>
</blockquote>
</li>
</ul>
<p><br  />
</p>
<ul>
<li><b>Compute per-residue (column-wise) NEFF:</b> <div class="fragment"><div class="line">./neff --file=../MSAs/example.a2m --check_validation=true --residue_neff=true</div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA sequence length: 56<br  />
 MSA depth: 5<br  />
 Per-residue (column-wise) NEFF:<br  />
 0.668153 0.534522 0.668153 0.534522 0.668153 0.668153 0.668153 0.668153 0.534522 0.534522 0.534522 0.668153 0.668153 0.668153 0.668153 0.668153 0.668153 0.668153 0.668153 0.668153 0.668153 0.668153 0.668153 0.668153 0.668153 0.534522 0.534522 0.534522 0.668153 0.400892 0.668153 0.668153 0.668153 0.668153 0.668153 0.668153 0.668153 0.668153 0.534522 0.534522 0.534522 0.534522 0.534522 0.400892 0.534522 0.534522 0.534522 0.400892 0.133631 0.133631 0.133631 0.133631 0.133631 0.133631 0.133631 0.133631<br  />
 Median of per-residue (column-wise) NEFF: 0.668153 </p>
</blockquote>
</li>
</ul>
<p><br  />
</p>
<ul>
<li><b>Compute Asymmetric NEFF for an Integration of MSAs with Default Normalization (sqrt(L)):</b> <div class="fragment"><div class="line">./neff --file=../MSAs/uniref90_hits.sto,../MSAs/bfd_uniclust_hits.a3m,../MSAs/mgnify_hits.sto --depth=2048 --is_symmetric=false</div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA length: 338<br  />
 MSA depth: 2048<br  />
 NEFF: 106.067 </p>
</blockquote>
</li>
</ul>
<p>The tool will integrate MSAs from the list of files in the specified order and compute the NEFF value for the integrated MSA up to a depth of 2048. If the tool reaches the specified depth before all files are integrated, it will stop processing the remaining files.<br  />
 This process is akin to how AlphaFold2.3 produces the final MSA for a protein by combining three distinct MSAs.<br  />
 <br  />
<br  />
</p>
<ul>
<li><b>Compute NEFF for MSA of a Homomer (Default Normalization):</b> <div class="fragment"><div class="line">./neff --file=../MSAs/homomer.aln --multimer_MSA=true --stoichiom=A2</div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA sequence length: 102<br  />
 MSA depth: 2048<br  />
 NEff of entire MSA: 34.8453<br  />
 Neff of individual MSA: 49.2787<br  />
 </p>
</blockquote>
</li>
</ul>
<p>The tool will detect a single repetition of the individual MSA of the chain within the given MSA file and report the NEFF value for it. If the provided MSA is not in the format of a multimer MSA of a homomer (i.e., the same MSA file repeated 'n' times, where here n=2), the tool will raise an error. <br  />
<br  />
</p>
<ul>
<li><b>Compute NEFF for MSA of a Heteromer (L Normalization):</b> <div class="fragment"><div class="line">./neff --file=../MSAs/heteromer.aln --multimer_MSA=true --stoichiom=A2B1 --chain_length=51,73 --norm=1</div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA sequence length: 175<br  />
 MSA depth: 3072<br  />
 NEFF of entire MSA:3.2836<br  />
 NEFF of Paired MSA (depth=1024): 3.02721<br  />
 NEFF of Individual MSA for Chain A (depth=1024): 4.37843<br  />
 NEFF of Individual MSA for Chain B (depth=1024): 3.0194 </p>
</blockquote>
</li>
</ul>
<p>The tool will identify paired MSA sequences and the sequences for each individual MSA of chains in the given MSA file, assuming the first monomer has a length of 51 residues and the second has a length of 73. It will report NEFF values for the paired MSA as well as for the MSAs corresponding to unpaired sequences. If the provided MSA is not in the format of a multimer MSA of a heteromer, the tool will raise an error. <br  />
<br  />
</p>
<ul>
<li><b>Random Masking:</b> <div class="fragment"><div class="line">./neff --file=../MSAs/T1127.sto --mask_enabled=true --mask_frac=0.2 --mask_count=10 –norm=2 –threshold=0.6</div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA sequence length: 211<br  />
 MSA depth: 9949<br  />
 Initial NEFF: 37.7624<br  />
 NEFF values for each mask iteration have been saved in 'neff_values-thr_0.6-maskfrac_0.2.txt' with highest value: 38.7015<br  />
 Masked MSA file corresponding to the highest NEFF value has been saved in 'MSA_with_highest_neff-thr_0.6-maskfrac_0.2.fasta'<br  />
 Time taken for masking and NEFF computation: 63.027 seconds. </p>
</blockquote>
</li>
</ul>
<p>The tool will mask 20% of sequences in 'T1127.sto' MSA file and repeat this process 10 times. The NEFF values from each iteration will be saved in a 'txt' file. The masked MSA corresponding to the highest NEFF value will also be saved in a 'fasta' file, representing the denoised MSA of the given MSA, which can be used for downstream tasks requiring a high-quality MSA.</p>
<p><br  />
</p>
<p><a class="anchor" id="converter"></a></p>
<h2><a class="anchor" id="autotoc_md70"></a>
MSA File Conversion</h2>
<p>To convert an MSA file, specify the input file, output file, and the desired input and output formats. The tool will read the input file, perform the conversion, and write the resulting MSA to the output file in the specified format.</p>
<p><a class="anchor" id="converter_usage"></a></p>
<h3><a class="anchor" id="autotoc_md71"></a>
Usage:</h3>
<div class="fragment"><div class="line">./converter --in_file=&lt;input_file&gt; --out_file=&lt;input_file&gt; [options]</div>
</div><!-- fragment --><p> <a class="anchor" id="converter_parameters"></a></p>
<h3><a class="anchor" id="autotoc_md72"></a>
Parameters:</h3>
<p>The code accepts the following command-line flags: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Flag   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Required   </th><th class="markdownTableHeadNone">Default Value   </th><th class="markdownTableHeadNone">Example    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>--in_file=&lt;filename&gt;</code>   </td><td class="markdownTableBodyNone">Specifies the input MSA file to be converted.<br  />
 Replace <code>&lt;filename&gt;</code> with the path and name of the input file   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone"><code>--in_file=input.fasta</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>--out_file=&lt;filename&gt;</code>   </td><td class="markdownTableBodyNone">Specifies the output file where the converted MSA will be saved.<br  />
 Replace <code>&lt;filename&gt;</code> with the desired path and name of the output file   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone"><code>--out_file=output.a2m</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>--alphabet=&lt;value&gt;</code>   </td><td class="markdownTableBodyNone">Alphabet of MSA <br  />
 <b>0</b>: Protein <br  />
 <b>1</b>: RNA <br  />
 <b>2</b>: DNA   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone"><code>--alphabet=1</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>--check_validation=[true/false]</code>   </td><td class="markdownTableBodyNone">Validate the input MSA file based on alphabet or not   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">true   </td><td class="markdownTableBodyNone"><code>--check_validation=true</code>   </td></tr>
</table>
<p>Please note that the conversion is performed based on the specified input and output file extensions.</p>
<p><a class="anchor" id="converter_example"></a></p>
<h3><a class="anchor" id="autotoc_md73"></a>
Examples:</h3>
<ul>
<li><b>Convert an A3M file to Stockholm format with RNA alphabet:</b> <div class="fragment"><div class="line">./converter --in_file=../MSAs/example.a2m --out_file=../MSAs/example.sto --alphabet=1</div>
</div><!-- fragment --></li>
<li><b>Convert a STO file to Clustal format without validation:</b> <div class="fragment"><div class="line">./converter --in_file=../MSAs/example.sto --out_file=../MSAs/example.clustal --check_validation=false</div>
</div><!-- fragment --></li>
<li><b>Convert an FASTA file to ALN format with RNA alphabet:</b> <div class="fragment"><div class="line">./converter --in_file=../MSAs/rna.fasta --out_file=../MSAs/rna.aln --alphabet=1</div>
</div><!-- fragment --></li>
</ul>
<p><br  />
</p>
<hr  />
<p> <a class="anchor" id="python"></a></p>
<h1><a class="anchor" id="autotoc_md75"></a>
Python Library</h1>
<p><a class="anchor" id="python_neff_main"></a></p>
<h2><a class="anchor" id="autotoc_md76"></a>
NEFF Computation</h2>
<p><a class="anchor" id="python_neff"></a></p>
<h2><a class="anchor" id="autotoc_md77"></a>
<code>compute_neff</code></h2>
<p><a class="anchor" id="python_neff_params"></a></p>
<h3><a class="anchor" id="autotoc_md78"></a>
Parameters:</h3>
<p>The method accepts the following parameters:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Required   </th><th class="markdownTableHeadNone">Default Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>file</code>   </td><td class="markdownTableBodyNone">list [string]   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone">Path to the input file containing the multiple sequence alignment (MSA)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>only_weights</code>   </td><td class="markdownTableBodyNone">bool   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">False   </td><td class="markdownTableBodyNone">Return only sequence weights, rather than the final NEFF    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>alphabet</code>   </td><td class="markdownTableBodyNone">Alphabet (Enum)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">Alphabet.Protein   </td><td class="markdownTableBodyNone">Enum to specify the type of sequences in the MSA (<b>Protein</b>, <b>RNA</b>, or <b>DNA</b>)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>check_validation</code>   </td><td class="markdownTableBodyNone">bool   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">False   </td><td class="markdownTableBodyNone">Validate the input MSA file based on alphabet or not    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>threshold</code>   </td><td class="markdownTableBodyNone">float   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">0.8   </td><td class="markdownTableBodyNone">Similarity threshold for sequence weighting, must be between 0 and 1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>norm</code>   </td><td class="markdownTableBodyNone">Normalization (Enum)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">Normalization.Sqrt_Length   </td><td class="markdownTableBodyNone">Enum to specify normalization method for NEFF (<b>Sqrt_Length</b>, <b>Length</b>, or <b>No_Normalization</b>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>omit_query_gaps</code>   </td><td class="markdownTableBodyNone">bool   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">True   </td><td class="markdownTableBodyNone">Omit gap positions of query sequence from all sequences for NEFF computation    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>is_symmetric</code>   </td><td class="markdownTableBodyNone">bool   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">True   </td><td class="markdownTableBodyNone">Consider gaps in number of differences when computing sequence similarity cutoff (asymmetric) or not (symmetric)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>non_standard_option</code>   </td><td class="markdownTableBodyNone">NonStandardOption (Enum)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">NonStandardOption.AsStandard   </td><td class="markdownTableBodyNone">Enum to handle non-standard residues of the specified alphabet (<b>AsStandard</b>, <b>ConsiderGapInCutoff</b>, <b>ConsiderGap</b>)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>depth</code>   </td><td class="markdownTableBodyNone">int   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">inf (consider the whole sequence)   </td><td class="markdownTableBodyNone">Depth of MSA to be used in NEFF computation (starting from the first sequence)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>gap_cutoff</code>   </td><td class="markdownTableBodyNone">float   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">1 (no gappy position)   </td><td class="markdownTableBodyNone">Threshold for considering a position as gappy and removing that (between 0 and 1)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>pos_start</code>   </td><td class="markdownTableBodyNone">int   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">1 (the first position)   </td><td class="markdownTableBodyNone">Start position of each sequence to be considered in NEFF (inclusive)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>pos_end</code>   </td><td class="markdownTableBodyNone">int   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">inf (consider the whole sequence)   </td><td class="markdownTableBodyNone">Last position of each sequence to be considered in NEFF (inclusive)   </td></tr>
</table>
<p><a class="anchor" id="python_neff_example"></a></p>
<h3><a class="anchor" id="autotoc_md79"></a>
Examples:</h3>
<ul>
<li><b>Compute Symmetric NEFF for protein MSA with No Normalization:</b> <div class="fragment"><div class="line">import neffy</div>
<div class="line"> </div>
<div class="line">def main():</div>
<div class="line">    try:</div>
<div class="line">        msa_length, msa_depth, neff = neffy.compute_neff(</div>
<div class="line">          file=&#39;../MSAs/example.a2m&#39;,</div>
<div class="line">          norm=neffy.Normalization.No_Normalization</div>
<div class="line">          )</div>
<div class="line"> </div>
<div class="line">        print(f&quot;MSA length: {msa_length}&quot;)</div>
<div class="line">        print(f&quot;MSA depth: {msa_depth}&quot;)</div>
<div class="line">        print(f&quot;NEFF: {neff}&quot;)</div>
<div class="line"> </div>
<div class="line">    except RuntimeError as e:</div>
<div class="line">        print(e)</div>
<div class="line"> </div>
<div class="line">if __name__ == &quot;__main__&quot;:</div>
<div class="line">    main()</div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA length: 56<br  />
 MSA depth: 5<br  />
 NEFF: 5.0 <br  />
 </p>
</blockquote>
</li>
</ul>
<p><br  />
</p>
<ul>
<li><b>Compute NEFF for RNA MSA with Default Normalization (sqrt(L)) using 50% Gap Cutoff:</b> <div class="fragment"><div class="line">import neffy</div>
<div class="line"> </div>
<div class="line">def main():</div>
<div class="line">    try:</div>
<div class="line">        msa_length, msa_depth, neff = neffy.compute_neff(</div>
<div class="line">          file=&#39;../MSAs/rna.fasta&#39;,</div>
<div class="line">          alphabet=neffy.Alphabet.RNA,</div>
<div class="line">          gap_cutoff=0.5)</div>
<div class="line"> </div>
<div class="line">        print(f&quot;MSA length: {msa_length}&quot;)</div>
<div class="line">        print(f&quot;MSA depth: {msa_depth}&quot;)</div>
<div class="line">        print(f&quot;NEFF: {neff}&quot;)</div>
<div class="line"> </div>
<div class="line">    except RuntimeError as e:</div>
<div class="line">        print(e)</div>
<div class="line"> </div>
<div class="line">if __name__ == &quot;__main__&quot;:</div>
<div class="line">    main()</div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA length: 28<br  />
 MSA depth: 1176<br  />
 NEFF: 5.08477 </p>
</blockquote>
</li>
</ul>
<p><br  />
</p>
<ul>
<li><b>Compute <a class="el" href="struct_sequence.html">Sequence</a> Weights for protein MSA with Default Normalization (sqrt(L)):</b> <div class="fragment"><div class="line">import neffy</div>
<div class="line"> </div>
<div class="line">def main():</div>
<div class="line">    try:</div>
<div class="line">        msa_length, msa_depth, weights = neffy.compute_neff(</div>
<div class="line">          file=&#39;../MSAs/example.a2m&#39;,</div>
<div class="line">          only_weights=True,</div>
<div class="line">          threshold=0.2)</div>
<div class="line"> </div>
<div class="line">        print(f&quot;MSA length: {msa_length}&quot;)</div>
<div class="line">        print(f&quot;MSA depth: {msa_depth}&quot;)</div>
<div class="line">        print(f&quot;Sequence weights: {weights}&quot;)</div>
<div class="line"> </div>
<div class="line">    except RuntimeError as e:</div>
<div class="line">        print(e)</div>
<div class="line"> </div>
<div class="line">if __name__ == &quot;__main__&quot;:</div>
<div class="line">    main()</div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA length: 56<br  />
 MSA depth: 5<br  />
 <a class="el" href="struct_sequence.html">Sequence</a> weights: [1.0, 0.333333, 0.25, 0.333333, 0.25] </p>
</blockquote>
</li>
</ul>
<p><br  />
</p>
<ul>
<li><b>Compute Asymmetric NEFF for an Integration of MSAs with Default Normalization (sqrt(L)):</b> <div class="fragment"><div class="line">import neffy</div>
<div class="line"> </div>
<div class="line">def main():</div>
<div class="line">    try:</div>
<div class="line">        msa_length, msa_depth, neff = neffy.compute_neff(</div>
<div class="line">            file=[&#39;../MSAs/uniref90_hits.sto&#39;, &#39;../MSAs/bfd_uniclust_hits.a3m&#39;, &#39;../MSAs/mgnify_hits.sto&#39;],</div>
<div class="line">            is_symmetric = False,</div>
<div class="line">            depth=2048)</div>
<div class="line"> </div>
<div class="line">        print(f&quot;MSA length: {msa_length}&quot;)</div>
<div class="line">        print(f&quot;MSA depth: {msa_depth}&quot;)</div>
<div class="line">        print(f&quot;NEFF: {neff}&quot;)</div>
<div class="line"> </div>
<div class="line">    except RuntimeError as e:</div>
<div class="line">        print(e)</div>
<div class="line"> </div>
<div class="line">if __name__ == &quot;__main__&quot;:</div>
<div class="line">    main()</div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA length: 338<br  />
 MSA depth: 2048<br  />
 NEFF: 106.067 </p>
</blockquote>
</li>
</ul>
<p>The tool will integrate MSAs from the list of files in the specified order and compute the NEFF value for the integrated MSA up to the gievn depth. If the tool reaches the specified depth before all files are integrated, it will stop processing the remaining files.<br  />
 This process is akin to how AlphaFold2.3 produces the final MSA for a protein by combining three distinct MSAs.<br  />
 <br  />
<br  />
</p>
<p><a class="anchor" id="python_neff_multimer"></a></p>
<h2><a class="anchor" id="autotoc_md80"></a>
<code>compute_multimer_neff</code></h2>
<p><a class="anchor" id="python_neff_multimer_params"></a></p>
<h3><a class="anchor" id="autotoc_md81"></a>
Parameters:</h3>
<p>The method accepts the following parameters:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Required   </th><th class="markdownTableHeadNone">Default Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>file</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone">Path to the input file containing the multiple sequence alignment (MSA)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>stoichiom</code>   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Stochiometry of the multimer    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>chain_length</code>   </td><td class="markdownTableBodyNone">list [int]   </td><td class="markdownTableBodyNone">when multimer is a heteromer   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Length of the chains in a heteromer    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>alphabet</code>   </td><td class="markdownTableBodyNone">Alphabet (Enum)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">Alphabet.Protein   </td><td class="markdownTableBodyNone">Enum to specify the type of sequences in the MSA (<b>Protein</b>, <b>RNA</b>, or <b>DNA</b>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>check_validation</code>   </td><td class="markdownTableBodyNone">bool   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">False   </td><td class="markdownTableBodyNone">Validate the input MSA file based on alphabet or not    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>threshold</code>   </td><td class="markdownTableBodyNone">float   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">0.8   </td><td class="markdownTableBodyNone">Similarity threshold for sequence weighting, must be between 0 and 1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>norm</code>   </td><td class="markdownTableBodyNone">Normalization (Enum)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">Normalization.Sqrt_Length   </td><td class="markdownTableBodyNone">Enum to specify normalization method for NEFF (<b>Sqrt_Length</b>, <b>Length</b>, or <b>No_Normalization</b>)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>omit_query_gaps</code>   </td><td class="markdownTableBodyNone">bool   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">True   </td><td class="markdownTableBodyNone">Omit gap positions of query sequence from all sequences for NEFF computation    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>is_symmetric</code>   </td><td class="markdownTableBodyNone">bool   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">True   </td><td class="markdownTableBodyNone">Consider gaps in number of differences when computing sequence similarity cutoff (asymmetric) or not (symmetric)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>non_standard_option</code>   </td><td class="markdownTableBodyNone">NonStandardOption (Enum)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">NonStandardOption.AsStandard   </td><td class="markdownTableBodyNone">Enum to handle non-standard residues of the specified alphabet (<b>AsStandard</b>, <b>ConsiderGapInCutoff</b>, <b>ConsiderGap</b>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>depth</code>   </td><td class="markdownTableBodyNone">int   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">inf (consider the whole sequence)   </td><td class="markdownTableBodyNone">Depth of MSA to be used in NEFF computation (starting from the first sequence)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>gap_cutoff</code>   </td><td class="markdownTableBodyNone">float   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">1 (no gappy position)   </td><td class="markdownTableBodyNone">Threshold for considering a position as gappy and removing that (between 0 and 1)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>pos_start</code>   </td><td class="markdownTableBodyNone">int   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">1 (the first position)   </td><td class="markdownTableBodyNone">Start position of each sequence to be considered in NEFF (inclusive)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>pos_end</code>   </td><td class="markdownTableBodyNone">int   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">inf (consider the whole sequence)   </td><td class="markdownTableBodyNone">Last position of each sequence to be considered in NEFF (inclusive)   </td></tr>
</table>
<p><a class="anchor" id="python_neff_multimer_example"></a></p>
<h3><a class="anchor" id="autotoc_md82"></a>
Examples:</h3>
<ul>
<li><b>Compute NEFF for MSA of a Homomer (Default Normalization):</b> <div class="fragment"><div class="line">import neffy</div>
<div class="line"> </div>
<div class="line">def main():</div>
<div class="line">    try:</div>
<div class="line">        msa_length, msa_depth, entire_neff, neff_values = neffy.compute_multimer_neff(</div>
<div class="line">          file=&#39;../MSAs/homomer.aln&#39;,</div>
<div class="line">          stoichiom=&quot;A2&quot;</div>
<div class="line">          )</div>
<div class="line"> </div>
<div class="line">        print(f&quot;MSA length: {msa_length}&quot;)</div>
<div class="line">        print(f&quot;MSA depth: {msa_depth}&quot;)</div>
<div class="line">        print(f&quot;NEff of entire MSA: {entire_neff}&quot;)</div>
<div class="line">        print(f&quot;neff of individual MSA: {neff_values}&quot;)</div>
<div class="line"> </div>
<div class="line">    except RuntimeError as e:</div>
<div class="line">        print(e)</div>
<div class="line"> </div>
<div class="line">if __name__ == &quot;__main__&quot;:</div>
<div class="line">    main()</div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA length: 102<br  />
 MSA depth: 2048<br  />
 NEFF of entire MSA: 34.8453<br  />
 NEFF of individual MSA: 49.2787 </p>
</blockquote>
</li>
</ul>
<p>The tool will detect a single repetition of the individual MSA of the chain within the given MSA file and report the NEFF value for it. If the provided MSA is not in the format of a multimer MSA of a homomer (i.e., the same MSA file repeated 'n' times given in 'stoichiom'), the tool will raise an error. <br  />
<br  />
</p>
<ul>
<li><b>Compute NEFF for MSA of a Heteromer (L Normalization):</b> <div class="fragment"><div class="line">import neffy</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">def main():</div>
<div class="line">    try:</div>
<div class="line">        msa_length, msa_depth, entire_neff, neff_values = neffy.compute_multimer_neff(</div>
<div class="line">              file=&#39;../MSAs/heteromer.aln&#39;,</div>
<div class="line">              stoichiom=&quot;A2B1&quot;,</div>
<div class="line">              chain_length=[51, 73],</div>
<div class="line">              norm=neffy.Normalization.Length)</div>
<div class="line"> </div>
<div class="line">        print(f&quot;MSA length: {msa_length}&quot;)</div>
<div class="line">        print(f&quot;MSA depth: {msa_depth}&quot;)</div>
<div class="line">        print(f&quot;NEff of entire MSA: {entire_neff}&quot;)</div>
<div class="line">        print(f&quot;NEFF values: {neff_values}&quot;)</div>
<div class="line"> </div>
<div class="line">    except RuntimeError as e:</div>
<div class="line">        print(e)</div>
<div class="line"> </div>
<div class="line">if __name__ == &quot;__main__&quot;:</div>
<div class="line">    main()</div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA length: 175<br  />
 MSA depth: 3072<br  />
 NEff of entire MSA: 3.2836<br  />
 NEFF values: {'paired': {'neff': 3.02721, 'depth': 1024}, 'A': {'neff': 4.37843, 'depth': 1024}, 'B': {'neff': 3.0194, 'depth': 1024}} </p>
</blockquote>
</li>
</ul>
<p>The tool will identify paired MSA sequences and the sequences for each individual MSA of chains in the given MSA file, based on the given lengths in 'chain_length'. It will report NEFF values for the paired MSA as well as for the MSAs corresponding to unpaired sequences. If the provided MSA is not in the format of a multimer MSA of a heteromer, the tool will raise an error. <br  />
<br  />
</p>
<p><a class="anchor" id="python_neff_residue"></a></p>
<h2><a class="anchor" id="autotoc_md83"></a>
<code>compute_residue_neff</code></h2>
<p><a class="anchor" id="python_neff_residue_params"></a></p>
<h3><a class="anchor" id="autotoc_md84"></a>
Parameters:</h3>
<p>The method accepts the following parameters:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Required   </th><th class="markdownTableHeadNone">Default Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>file</code>   </td><td class="markdownTableBodyNone">list [string]   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone">Path to the input file containing the multiple sequence alignment (MSA)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>alphabet</code>   </td><td class="markdownTableBodyNone">Alphabet (Enum)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">Alphabet.Protein   </td><td class="markdownTableBodyNone">Enum to specify the type of sequences in the MSA (<b>Protein</b>, <b>RNA</b>, or <b>DNA</b>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>check_validation</code>   </td><td class="markdownTableBodyNone">bool   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">False   </td><td class="markdownTableBodyNone">Validate the input MSA file based on alphabet or not    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>threshold</code>   </td><td class="markdownTableBodyNone">float   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">0.8   </td><td class="markdownTableBodyNone">Similarity threshold for sequence weighting, must be between 0 and 1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>norm</code>   </td><td class="markdownTableBodyNone">Normalization (Enum)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">Normalization.Sqrt_Length   </td><td class="markdownTableBodyNone">Enum to specify normalization method for NEFF (<b>Sqrt_Length</b>, <b>Length</b>, or <b>No_Normalization</b>)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>omit_query_gaps</code>   </td><td class="markdownTableBodyNone">bool   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">True   </td><td class="markdownTableBodyNone">Omit gap positions of query sequence from all sequences for NEFF computation    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>is_symmetric</code>   </td><td class="markdownTableBodyNone">bool   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">True   </td><td class="markdownTableBodyNone">Consider gaps in number of differences when computing sequence similarity cutoff (asymmetric) or not (symmetric)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>non_standard_option</code>   </td><td class="markdownTableBodyNone">NonStandardOption (Enum)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">NonStandardOption.AsStandard   </td><td class="markdownTableBodyNone">Enum to handle non-standard residues of the specified alphabet (<b>AsStandard</b>, <b>ConsiderGapInCutoff</b>, <b>ConsiderGap</b>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>depth</code>   </td><td class="markdownTableBodyNone">int   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">inf (consider the whole sequence)   </td><td class="markdownTableBodyNone">Depth of MSA to be used in NEFF computation (starting from the first sequence)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>gap_cutoff</code>   </td><td class="markdownTableBodyNone">float   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">1 (no gappy position)   </td><td class="markdownTableBodyNone">Threshold for considering a position as gappy and removing that (between 0 and 1)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>pos_start</code>   </td><td class="markdownTableBodyNone">int   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">1 (the first position)   </td><td class="markdownTableBodyNone">Start position of each sequence to be considered in NEFF (inclusive)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>pos_end</code>   </td><td class="markdownTableBodyNone">int   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">inf (consider the whole sequence)   </td><td class="markdownTableBodyNone">Last position of each sequence to be considered in NEFF (inclusive)   </td></tr>
</table>
<p><a class="anchor" id="python_neff_residue_example"></a></p>
<h3><a class="anchor" id="autotoc_md85"></a>
Examples:</h3>
<ul>
<li><b>Compute per-residue (column-wise) NEFF:</b> <div class="fragment"><div class="line">import neffy</div>
<div class="line"> </div>
<div class="line">def main():</div>
<div class="line">    try:</div>
<div class="line">        msa_length, msa_depth, residue_neffs, median = neffy.compute_residue_neff(</div>
<div class="line">          file=&#39;../MSAs/example.a2m&#39;,</div>
<div class="line">          check_validation=True)</div>
<div class="line"> </div>
<div class="line">        print(f&quot;MSA length: {msa_length}&quot;)</div>
<div class="line">        print(f&quot;MSA depth: {msa_depth}&quot;)</div>
<div class="line">        print(&quot;Per-residue (column-wise) NEFF:\n&quot;, residue_neffs)</div>
<div class="line">        print(&quot;Median of per-residue (column-wise) NEFF:&quot;, median)</div>
<div class="line"> </div>
<div class="line">    except RuntimeError as e:</div>
<div class="line">        print(e)</div>
<div class="line"> </div>
<div class="line">if __name__ == &quot;__main__&quot;:</div>
<div class="line">    main()</div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA length: 56<br  />
 MSA depth: 5<br  />
 Per-residue (column-wise) NEFF:<br  />
 [0.668153, 0.534522, 0.668153, 0.534522, 0.668153, 0.668153, 0.668153, 0.668153, 0.534522, 0.534522, 0.534522, 0.668153, 0.668153, 0.668153, 0.668153, 0.668153, 0.668153, 0.668153, 0.668153, 0.668153, 0.668153, 0.668153, 0.668153, 0.668153, 0.668153, 0.534522, 0.534522, 0.534522, 0.668153, 0.400892, 0.668153, 0.668153, 0.668153, 0.668153, 0.668153, 0.668153, 0.668153, 0.668153, 0.534522, 0.534522, 0.534522, 0.534522, 0.534522, 0.400892, 0.534522, 0.534522, 0.534522, 0.400892, 0.133631, 0.133631, 0.133631, 0.133631, 0.133631, 0.133631, 0.133631, 0.133631]<br  />
 Median of per-residue (column-wise) NEFF: 0.668153 </p>
</blockquote>
</li>
</ul>
<p><br  />
</p>
<p><a class="anchor" id="python_neff_masking"></a></p>
<h2><a class="anchor" id="autotoc_md86"></a>
<code>compute_neff_masking</code></h2>
<p><a class="anchor" id="python_neff_masking_params"></a></p>
<h3><a class="anchor" id="autotoc_md87"></a>
Parameters:</h3>
<p>The method accepts the following parameters:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Required   </th><th class="markdownTableHeadNone">Default Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>file</code>   </td><td class="markdownTableBodyNone">list [string]   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone">Path to the input file containing the multiple sequence alignment (MSA)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>mask_frac</code>   </td><td class="markdownTableBodyNone">float   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Fraction of sequences to be masked in each masking iteration, must be between 0 and 1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>mask_count</code>   </td><td class="markdownTableBodyNone">int   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Number of masking iterations    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>alphabet</code>   </td><td class="markdownTableBodyNone">Alphabet (Enum)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">Alphabet.Protein   </td><td class="markdownTableBodyNone">Enum to specify the type of sequences in the MSA (<b>Protein</b>, <b>RNA</b>, or <b>DNA</b>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>check_validation</code>   </td><td class="markdownTableBodyNone">bool   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">False   </td><td class="markdownTableBodyNone">Validate the input MSA file based on alphabet or not    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>threshold</code>   </td><td class="markdownTableBodyNone">float   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">0.8   </td><td class="markdownTableBodyNone">Similarity threshold for sequence weighting, must be between 0 and 1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>norm</code>   </td><td class="markdownTableBodyNone">Normalization (Enum)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">Normalization.Sqrt_Length   </td><td class="markdownTableBodyNone">Enum to specify normalization method for NEFF (<b>Sqrt_Length</b>, <b>Length</b>, or <b>No_Normalization</b>)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>omit_query_gaps</code>   </td><td class="markdownTableBodyNone">bool   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">True   </td><td class="markdownTableBodyNone">Omit gap positions of query sequence from all sequences for NEFF computation    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>is_symmetric</code>   </td><td class="markdownTableBodyNone">bool   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">True   </td><td class="markdownTableBodyNone">Consider gaps in number of differences when computing sequence similarity cutoff (asymmetric) or not (symmetric)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>non_standard_option</code>   </td><td class="markdownTableBodyNone">NonStandardOption (Enum)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">NonStandardOption.AsStandard   </td><td class="markdownTableBodyNone">Enum to handle non-standard residues of the specified alphabet (<b>AsStandard</b>, <b>ConsiderGapInCutoff</b>, <b>ConsiderGap</b>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>depth</code>   </td><td class="markdownTableBodyNone">int   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">inf (consider the whole sequence)   </td><td class="markdownTableBodyNone">Depth of MSA to be used in NEFF computation (starting from the first sequence)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>gap_cutoff</code>   </td><td class="markdownTableBodyNone">float   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">1 (no gappy position)   </td><td class="markdownTableBodyNone">Threshold for considering a position as gappy and removing that (between 0 and 1)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>pos_start</code>   </td><td class="markdownTableBodyNone">int   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">1 (the first position)   </td><td class="markdownTableBodyNone">Start position of each sequence to be considered in NEFF (inclusive)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>pos_end</code>   </td><td class="markdownTableBodyNone">int   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">inf (consider the whole sequence)   </td><td class="markdownTableBodyNone">Last position of each sequence to be considered in NEFF (inclusive)   </td></tr>
</table>
<p><a class="anchor" id="python_neff_masking_example"></a></p>
<h3><a class="anchor" id="autotoc_md88"></a>
Examples:</h3>
<ul>
<li><b>Random Masking:</b> <div class="fragment"><div class="line">import sys</div>
<div class="line">import neffy</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">def main():</div>
<div class="line">    try:</div>
<div class="line">        msa_length, msa_depth, initial_neff, highest_neff, result_file, masked_msa_with_highest_neff, time\</div>
<div class="line">            = neffy.compute_neff_masking(</div>
<div class="line">              file=&#39;../MSAs/T1127.sto&#39;,</div>
<div class="line">              threshold=0.6,</div>
<div class="line">              mask_count=10,</div>
<div class="line">              mask_frac=0.2,</div>
<div class="line">              norm=neffy.Normalization.No_Normalization)</div>
<div class="line"> </div>
<div class="line">        print(f&quot;MSA length: {msa_length}&quot;)</div>
<div class="line">        print(f&quot;MSA depth: {msa_depth}&quot;)</div>
<div class="line">        print(f&quot;Initial NEFF: {initial_neff}&quot;)</div>
<div class="line">        print(f&quot;Highest NEFF among maskings: {highest_neff}&quot;)</div>
<div class="line">        print(f&quot;Result file: {result_file}&quot;)</div>
<div class="line">        print(f&quot;Masked MSA with highest NEFF: {masked_msa_with_highest_neff}&quot;)</div>
<div class="line">        print(f&quot;Time taken: {time} seconds&quot;)</div>
<div class="line"> </div>
<div class="line">    except RuntimeError as e:</div>
<div class="line">        print(e)</div>
<div class="line"> </div>
<div class="line">if __name__ == &quot;__main__&quot;:</div>
<div class="line">    main()</div>
</div><!-- fragment --> Result: <blockquote class="doxtable">
<p>&zwj;MSA length: 211<br  />
 MSA depth: 9949<br  />
 Initial NEFF: 37.7624<br  />
 Highest NEFF among maskings: 38.7015<br  />
 Result file: neff_values-thr_0.6-maskfrac_0.2.txt<br  />
 Masked MSA with highest NEFF: MSA_with_highest_neff-thr_0.6-maskfrac_0.2.fasta<br  />
 Time taken: 73.5736 seconds </p>
</blockquote>
</li>
</ul>
<p>The tool will mask 'mask_frac' of sequences in MSA file and repeat this process 'mask-count' times. The NEFF values from each iteration will be saved in a 'txt' file. The masked MSA corresponding to the highest NEFF value will also be saved in a 'fasta' file, representing the denoised MSA of the given MSA, which can be used for downstream tasks requiring a high-quality MSA.</p>
<p><br  />
</p>
<p><a class="anchor" id="python_converter"></a></p>
<h2><a class="anchor" id="autotoc_md89"></a>
MSA File Conversion</h2>
<h2><a class="anchor" id="autotoc_md90"></a>
<code>convert_msa</code></h2>
<p><a class="anchor" id="python_convert_msa_params"></a></p>
<h3><a class="anchor" id="autotoc_md91"></a>
Parameters:</h3>
<p>The method accepts the following parameters:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Required   </th><th class="markdownTableHeadNone">Default Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">in_file   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone">Path to the input MSA file that needs to be converted    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">out_file   </td><td class="markdownTableBodyNone">string   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone">Path where the converted MSA file will be saved    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">alphabet   </td><td class="markdownTableBodyNone">Alphabet (Enum)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">Alphabet.Protein   </td><td class="markdownTableBodyNone">Enum to specify the type of sequences in the MSA (<b>Protein</b>, <b>RNA</b>, or <b>DNA</b>)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">check_validation   </td><td class="markdownTableBodyNone">bool   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">True   </td><td class="markdownTableBodyNone">Whether to check the validation of the MSA file before conversion   </td></tr>
</table>
<p><a class="anchor" id="python_convert_msa_example"></a></p>
<h3><a class="anchor" id="autotoc_md92"></a>
Example:</h3>
<div class="fragment"><div class="line">import sys</div>
<div class="line">import neffy</div>
<div class="line"> </div>
<div class="line">def main():</div>
<div class="line">    try:</div>
<div class="line">        output = neffy.convert_msa(</div>
<div class="line">          in_file=&#39;../MSAs/example.a2m&#39;,</div>
<div class="line">          out_file=&#39;../MSAs/example.sto&#39;)</div>
<div class="line"> </div>
<div class="line">        print(output)</div>
<div class="line"> </div>
<div class="line">    except RuntimeError as e:</div>
<div class="line">        print(e)</div>
<div class="line"> </div>
<div class="line">if __name__ == &quot;__main__&quot;:</div>
<div class="line">    main()</div>
</div><!-- fragment --><p><br  />
<br  />
 <span style="color:purple;"></span></p>
<p><span style="color:purple;">**** All example MSAs used here can be found in the <a href="https://github.com/Maryam-Haghani/NEFFy/tree/main/MSAs">'MSA' folder of Github repository</a>.</span></p>
<p><span style="color:purple;">**** All Python scripts used in the examples can be found in the <a href="https://github.com/Maryam-Haghani/NEFFy/tree/python-lib/example">'example' folder of Github repository</a>. </span></p>
<p><br  />
</p>
<hr  />
<p> For further assistance or inquiries, please <a href="#" onclick="location.href='mai'+'lto:'+'hag'+'ha'+'ni@'+'vt'+'.ed'+'u'; return false;">contact the developer</a> or create an <a href="https://github.com/Maryam-Haghani/Neffy/issues">issue</a> in the GitHub repository. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Footer</title>
  <style>
    .footer {
      padding: 10px;
      font-size: 14px;
      color: #888;
    }
    .footer-left {
      text-align: left;
    }
    .footer address, .footer p {
      margin: 0;
    }
  </style>
</head>
<body>
  <div class="footer">
    <div class="footer-left">
      <hr/>
      <address>
        <small>
          Generated by&#160;<a href="https://www.doxygen.org/index.html">
          <img src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
        </small>
      </address>
      <p>© Copyright 2024, Maryam Haghani</p>
    </div>
  </div>
</body>
</html>
